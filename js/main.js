(()=>{"use strict";function l(l,t,s,e,...i){let a=null;try{a=document.createElement(l)}catch(l){throw new Error("Unable to create HTMLElement! Give a proper tag name")}return t&&a.classList.add(...t.split(" ")),s&&Array.isArray(s)?s.forEach((l=>l&&a.appendChild(l))):s&&"object"==typeof s?a.appendChild(s):s&&"string"==typeof s&&(a.innerHTML=s),e&&e.appendChild(a),i.length&&i.forEach((([l,t])=>{""!==t?l.match(/value|id|placeholder|cols|rows|autocorrect|spellcheck/)?a.setAttribute(l,t):a.dataset[l]=t:a.setAttribute(l,"")})),a}const t={ru:[{small:"Escape",shift:null,code:"Escape"},{small:"F1",shift:null,code:"F1"},{small:"F2",shift:null,code:"F2"},{small:"F3",shift:null,code:"F3"},{small:"F4",shift:null,code:"F4"},{small:"F5",shift:null,code:"F5"},{small:"F6",shift:null,code:"F6"},{small:"F7",shift:null,code:"F7"},{small:"F8",shift:null,code:"F8"},{small:"F9",shift:null,code:"F9"},{small:"F10",shift:null,code:"F10"},{small:"F11",shift:null,code:"F11"},{small:"F12",shift:null,code:"F12"},{small:"PrintScreen",shift:null,code:"PrintScreen"},{small:"Del",shift:null,code:"Delete"},{small:"Home",shift:null,code:"Numpad7"},{small:"PgUp",shift:null,code:"Numpad9"},{small:"PgDn",shift:null,code:"Numpad3"},{small:"End",shift:null,code:"Numpad1"},{small:"ё",shift:"Ё",code:"Backquote"},{small:"1",shift:"!",code:"Digit1"},{small:"2",shift:'"',code:"Digit2"},{small:"3",shift:"№",code:"Digit3"},{small:"4",shift:";",code:"Digit4"},{small:"5",shift:"%",code:"Digit5"},{small:"6",shift:":",code:"Digit6"},{small:"7",shift:"?",code:"Digit7"},{small:"8",shift:"*",code:"Digit8"},{small:"9",shift:"(",code:"Digit9"},{small:"0",shift:")",code:"Digit0"},{small:"-",shift:"_",code:"Minus"},{small:"=",shift:"+",code:"Equal"},{small:"Backspace",shift:null,code:"Backspace"},{small:"NumLock",shift:null,code:"NumLock"},{small:"/",shift:null,code:"NumpadDivide"},{small:"*",shift:null,code:"NumpadMultiply"},{small:"Tab",shift:"Tab",code:"Tab"},{small:"й",shift:"Й",code:"KeyQ"},{small:"ц",shift:"Ц",code:"KeyW"},{small:"у",shift:"У",code:"KeyE"},{small:"к",shift:"К",code:"KeyR"},{small:"е",shift:"Е",code:"KeyT"},{small:"н",shift:"Н",code:"KeyY"},{small:"г",shift:"Г",code:"KeyU"},{small:"ш",shift:"Ш",code:"KeyI"},{small:"щ",shift:"Щ",code:"KeyO"},{small:"з",shift:"З",code:"KeyP"},{small:"х",shift:"Х",code:"BracketLeft"},{small:"ъ",shift:"Ъ",code:"BracketRight"},{small:"\\",shift:"/",code:"Backslash"},{small:"7",shift:null,code:"Numpad7"},{small:"8",shift:null,code:"Numpad8"},{small:"9",shift:null,code:"Numpad9"},{small:"-",shift:null,code:"NumpadSubtract"},{small:"CapsLock",shift:null,code:"CapsLock"},{small:"ф",shift:"Ф",code:"KeyA"},{small:"ы",shift:"Ы",code:"KeyS"},{small:"в",shift:"В",code:"KeyD"},{small:"а",shift:"А",code:"KeyF"},{small:"п",shift:"П",code:"KeyG"},{small:"р",shift:"Р",code:"KeyH"},{small:"о",shift:"О",code:"KeyJ"},{small:"л",shift:"Л",code:"KeyK"},{small:"д",shift:"Д",code:"KeyL"},{small:"ж",shift:"Ж",code:"Semicolon"},{small:"э",shift:"Э",code:"Quote"},{small:"Enter",shift:"Enter",code:"Enter"},{small:"4",shift:null,code:"Numpad4"},{small:"5",shift:null,code:"Numpad5"},{small:"6",shift:null,code:"Numpad6"},{small:"+",shift:null,code:"NumpadAdd"},{small:"Shift",shift:null,code:"ShiftLeft"},{small:"я",shift:"Я",code:"KeyZ"},{small:"ч",shift:"Ч",code:"KeyX"},{small:"с",shift:"С",code:"KeyC"},{small:"м",shift:"М",code:"KeyV"},{small:"и",shift:"И",code:"KeyB"},{small:"т",shift:"Т",code:"KeyN"},{small:"ь",shift:"Ь",code:"KeyM"},{small:"б",shift:"Б",code:"Comma"},{small:"ю",shift:"Ю",code:"Period"},{small:".",shift:",",code:"Slash"},{small:"Shift",shift:null,code:"ShiftRight"},{small:"&uArr;",shift:null,code:"ArrowUp"},{small:"1",shift:null,code:"Numpad1"},{small:"2",shift:null,code:"Numpad2"},{small:"3",shift:null,code:"Numpad3"},{small:"Enter",shift:null,code:"NumpadEnter"},{small:"Ctrl",shift:null,code:"ControlLeft"},{small:"Meta",shift:null,code:"MetaLeft"},{small:"Alt",shift:null,code:"AltLeft"},{small:"___________",shift:null,code:"Space"},{small:"Alt",shift:null,code:"AltRight"},{small:"Menu",shift:null,code:"ContextMenu"},{small:"Ctrl",shift:null,code:"ControlRight"},{small:"&lArr;",shift:null,code:"ArrowLeft"},{small:"&dArr;",shift:null,code:"ArrowDown"},{small:"&rArr;",shift:null,code:"ArrowRight"},{small:"0",shift:null,code:"Numpad0"},{small:",",shift:null,code:"NumpadDecimal"}],en:[{small:"Escape",shift:null,code:"Escape"},{small:"F1",shift:null,code:"F1"},{small:"F2",shift:null,code:"F2"},{small:"F3",shift:null,code:"F3"},{small:"F4",shift:null,code:"F4"},{small:"F5",shift:null,code:"F5"},{small:"F6",shift:null,code:"F6"},{small:"F7",shift:null,code:"F7"},{small:"F8",shift:null,code:"F8"},{small:"F9",shift:null,code:"F9"},{small:"F10",shift:null,code:"F10"},{small:"F11",shift:null,code:"F11"},{small:"F12",shift:null,code:"F12"},{small:"PrintScreen",shift:null,code:"PrintScreen"},{small:"Del",shift:null,code:"Delete"},{small:"Home",shift:null,code:"Numpad7"},{small:"PgUp",shift:null,code:"Numpad9"},{small:"PgDn",shift:null,code:"Numpad3"},{small:"End",shift:null,code:"Numpad1"},{small:"`",shift:"~",code:"Backquote"},{small:"1",shift:"!",code:"Digit1"},{small:"2",shift:"@",code:"Digit2"},{small:"3",shift:"#",code:"Digit3"},{small:"4",shift:"$",code:"Digit4"},{small:"5",shift:"%",code:"Digit5"},{small:"6",shift:"^",code:"Digit6"},{small:"7",shift:"&",code:"Digit7"},{small:"8",shift:"*",code:"Digit8"},{small:"9",shift:"(",code:"Digit9"},{small:"0",shift:")",code:"Digit0"},{small:"-",shift:"_",code:"Minus"},{small:"=",shift:"+",code:"Equal"},{small:"Backspace",shift:null,code:"Backspace"},{small:"NumLock",shift:null,code:"NumLock"},{small:"/",shift:null,code:"NumpadDivide"},{small:"*",shift:null,code:"NumpadMultiply"},{small:"Tab",shift:"Tab",code:"Tab"},{small:"q",shift:"Q",code:"KeyQ"},{small:"w",shift:"W",code:"KeyW"},{small:"e",shift:"E",code:"KeyE"},{small:"r",shift:"R",code:"KeyR"},{small:"t",shift:"T",code:"KeyT"},{small:"y",shift:"Y",code:"KeyY"},{small:"u",shift:"U",code:"KeyU"},{small:"i",shift:"I",code:"KeyI"},{small:"o",shift:"O",code:"KeyO"},{small:"p",shift:"P",code:"KeyP"},{small:"[",shift:"{",code:"BracketLeft"},{small:"]",shift:"}",code:"BracketRight"},{small:"\\",shift:"|",code:"Backslash"},{small:"7",shift:null,code:"Numpad7"},{small:"8",shift:null,code:"Numpad8"},{small:"9",shift:null,code:"Numpad9"},{small:"-",shift:null,code:"NumpadSubtract"},{small:"CapsLock",shift:null,code:"CapsLock"},{small:"a",shift:"A",code:"KeyA"},{small:"s",shift:"S",code:"KeyS"},{small:"d",shift:"D",code:"KeyD"},{small:"f",shift:"F",code:"KeyF"},{small:"g",shift:"G",code:"KeyG"},{small:"h",shift:"H",code:"KeyH"},{small:"j",shift:"J",code:"KeyJ"},{small:"k",shift:"K",code:"KeyK"},{small:"l",shift:"L",code:"KeyL"},{small:";",shift:":",code:"Semicolon"},{small:"'",shift:'"',code:"Quote"},{small:"Enter",shift:"Enter",code:"Enter"},{small:"4",shift:null,code:"Numpad4"},{small:"5",shift:null,code:"Numpad5"},{small:"6",shift:null,code:"Numpad6"},{small:"+",shift:null,code:"NumpadAdd"},{small:"Shift",shift:null,code:"ShiftLeft"},{small:"z",shift:"Z",code:"KeyZ"},{small:"x",shift:"X",code:"KeyX"},{small:"c",shift:"C",code:"KeyC"},{small:"v",shift:"V",code:"KeyV"},{small:"b",shift:"B",code:"KeyB"},{small:"n",shift:"N",code:"KeyN"},{small:"m",shift:"M",code:"KeyM"},{small:",",shift:"<",code:"Comma"},{small:".",shift:">",code:"Period"},{small:"/",shift:"?",code:"Slash"},{small:"Shift",shift:null,code:"ShiftRight"},{small:"&uArr;",shift:null,code:"ArrowUp"},{small:"1",shift:null,code:"Numpad1"},{small:"2",shift:null,code:"Numpad2"},{small:"3",shift:null,code:"Numpad3"},{small:"Enter",shift:null,code:"NumpadEnter"},{small:"Ctrl",shift:null,code:"ControlLeft"},{small:"Meta",shift:null,code:"MetaLeft"},{small:"Alt",shift:null,code:"AltLeft"},{small:"___________",shift:null,code:"Space"},{small:"Alt",shift:null,code:"AltRight"},{small:"Menu",shift:null,code:"ContextMenu"},{small:"Ctrl",shift:null,code:"ControlRight"},{small:"&lArr;",shift:null,code:"ArrowLeft"},{small:"&dArr;",shift:null,code:"ArrowDown"},{small:"&rArr;",shift:null,code:"ArrowRight"},{small:"0",shift:null,code:"Numpad0"},{small:".",shift:null,code:"NumpadDecimal"}]};class s{constructor({small:t,shift:s,code:e}){this.code=e,this.small=t,this.shift=s,this.isFnKey=Boolean(t.match(/Ctrl|Arr|Alt|Shift|Tab|Backspace|Del|Enter|CapsLock|Meta|Menu|__/)),s&&s.match(/[^a-zA-Zа-яА-ЯёЁ0-9]/)?this.sub=l("div","sub",this.shift):this.sub=l("div","sub",""),this.letter=l("div","letter",t),this.div=l("div","keyboard__key",[this.sub,this.letter],null,["code",this.code],this.isFnKey?["fn","true"]:["fn","false"])}}const e=l("main","",[l("h1","title","RSS Virtual Keyboard"),l("h3","subtitle","Клавиатура создана в операционной системе Windows"),l("p","hint","Для переключения языка используйте левые <kbd>Ctrl</kbd> + <kbd>Alt</kbd>")]),i=function(l,t=null){return JSON.parse(window.localStorage.getItem(l)||t)}("kbLang",'"ru"');new class{constructor(l){this.rowsOrder=l,this.keysPressed={},this.isCaps=!1}init(s){return this.keyBase=t[s],this.output=l("textarea","output",null,e,["placeholder","Начните печатать..."],["rows",5],["cols",50],["spellcheck",!1],["autocorrect","off"]),this.container=l("div","keyboard",null,e,["language",s]),document.body.prepend(e),this}generateLayout(){this.keyButtons=[],this.rowsOrder.forEach(((t,e)=>{const i=l("div","keyboard__row",null,this.container,["row",e+1]);i.style.gridTemplateColumns=`repeat(${t.length}, 1fr)`,t.forEach((l=>{const t=this.keyBase.find((t=>t.code===l));if(t){const l=new s(t);this.keyButtons.push(l),i.appendChild(l.div)}}))})),document.addEventListener("keydown",this.handleEvent),document.addEventListener("keyup",this.handleEvent),this.container.onmousedown=this.preHandleEvent,this.container.onmouseup=this.preHandleEvent}preHandleEvent=l=>{l.stopPropagation();const t=l.target.closest(".keyboard__key");if(!t)return;const{dataset:{code:s}}=t;t.addEventListener("mouseleave",this.resetButtonState),this.handleEvent({code:s,type:l.type})};resetButtonState=({target:{dataset:{code:l}}})=>{const t=this.keyButtons.find((t=>t.code===l));t.div.classList.remove("active"),t.div.removeEventListener("mouseleave",this.resetButtonState)};handleEvent=l=>{l.stopPropagation&&l.stopPropagation();const{code:t,type:s}=l,e=this.keyButtons.find((l=>l.code===t));e&&(this.output.focus(),s.match(/keydown|mousedown/)?(s.match(/key/)&&l.preventDefault(),t.match(/Shift/)&&(this.shiftKey=!0),this.shiftKey&&this.switchUpperCase(!0),e.div.classList.add("active"),t.match(/Caps/)&&!this.isCaps?(this.isCaps=!0,this.switchUpperCase(!0)):t.match(/Caps/)&&this.isCaps&&(this.isCaps=!1,this.switchUpperCase(!1),e.div.classList.remove("active")),t.match(/Control/)&&(this.ctrlKey=!0),t.match(/Alt/)&&(this.altKey=!0),t.match(/Control/)&&this.altKey&&this.switchLanguage(),t.match(/Alt/)&&this.ctrlKey&&this.switchLanguage(),this.isCaps?this.isCaps&&(this.shiftKey?this.printToOutput(e,e.sub.innerHTML?e.shift:e.small):this.printToOutput(e,e.sub.innerHTML?e.small:e.shift)):this.printToOutput(e,this.shiftKey?e.shift:e.small)):s.match(/keyup|mouseup/)&&(t.match(/Shift/)&&(this.shiftKey=!1,this.switchUpperCase(!1)),t.match(/Control/)&&(this.ctrlKey=!1),t.match(/Alt/)&&(this.altKey=!1),t.match(/Caps/)||e.div.classList.remove("active")))};switchLanguage=()=>{const l=Object.keys(t);let s=l.indexOf(this.container.dataset.language);var e;this.keyBase=s+1<l.length?t[l[s+=1]]:t[l[s-=s]],this.container.dataset.language=l[s],e=l[s],window.localStorage.setItem("kbLang",JSON.stringify(e)),this.keyButtons=this.keyButtons.map((l=>{const t={...l},s=this.keyBase.find((t=>t.code===l.code));return s?(t.shift=s.shift,t.small=s.small,s.shift&&s.shift.match(/[^a-zA-Zа-яА-ЯёЁ0-9]/g)?t.sub.innerHTML=s.shift:t.sub.innerHTML="",t.letter.innerHTML=s.small,t):t})),this.isCaps&&this.switchUpperCase(!0)};switchUpperCase(l){this.keyButtons=l?this.keyButtons.map((l=>{const t={...l};return l.sub.innerHTML&&this.shiftKey&&(t.sub.classList.add("sub-active"),t.letter.classList.add("sub-inactive")),l.isFnKey||!this.isCaps||this.shiftKey||l.sub.innerHTML?!l.isFnKey&&this.isCaps&&this.shiftKey?t.letter.innerHTML=l.small:l.isFnKey||l.sub.innerHTML||(t.letter.innerHTML=l.shift):t.letter.innerHTML=l.shift,t})):this.keyButtons.map((l=>{const t={...l};return l.sub.innerHTML&&!l.isFnKey?(t.sub.classList.remove("sub-active"),t.letter.classList.remove("sub-inactive"),this.isCaps||(t.letter.innerHTML=l.small)):l.isFnKey||(this.isCaps?t.letter.innerHTML=l.shift:t.letter.innerHTML=l.small),t}))}printToOutput(l,t){let s=this.output.selectionStart;const e=this.output.value.slice(0,s),i=this.output.value.slice(s),a={Tab:()=>{this.output.value=`${e}\t${i}`,s+=1},ArrowLeft:()=>{s=s-1>=0?s-1:0},ArrowRight:()=>{s+=1},ArrowUp:()=>{const l=this.output.value.slice(0,s).match(/(\n).*$(?!\1)/g)||[[1]];s-=l[0].length},ArrowDown:()=>{const l=this.output.value.slice(s).match(/^.*(\n).*(?!\1)/)||[[1]];s+=l[0].length},Enter:()=>{this.output.value=`${e}\n${i}`,s+=1},Delete:()=>{this.output.value=`${e}${i.slice(1)}`},Backspace:()=>{this.output.value=`${e.slice(0,-1)}${i}`,s-=1},Space:()=>{this.output.value=`${e} ${i}`,s+=1}};a[l.code]?a[l.code]():l.isFnKey||(s+=1,this.output.value=`${e}${t||""}${i}`),this.output.setSelectionRange(s,s)}}([["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight"],["ControlLeft","MetaLeft","AltLeft","Space","AltRight","ContextMenu","ControlRight","ArrowLeft","ArrowDown","ArrowRight"]]).init(i).generateLayout()})();